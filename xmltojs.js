const fs = require('fs');
const transform = require('camaro');
// const xml2js = require('xml2js');

const xml = fs.readFileSync('./test.xml', 'utf-8')
const template = {
    'ports': ['//ports', {
        'port': ['port', {
                'protocol': '@protocol',
                'portid': '@portid',
                'state': 'state/@state',
                'reason': 'state/@reason',
                'service': 'service/@name',
        }],
    }]
};

const result = transform(xml, template);
const ports = JSON.stringify(result.ports)
console.log(ports);

/*
let xmldata = {}
let parser = new xml2js.Parser();
fs.readFile('./test.xml', function(err, data) {
    parser.parseString(data, function(err, result) {
        let xmldata = JSON.parse(JSON.stringify(result));
        let scaninfo = xmldata
        console.dir(xmldata);
        console.log('Done');
    });
});
*/
