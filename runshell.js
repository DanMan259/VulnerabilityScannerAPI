const shell = require('shelljs');

if (!shell.which('nmap') || !shell.which('searchsploit')) {
    shell.echo('Sorry, this script requires nmap and searchsploit');
    shell.exit(1);
}

if (shell.exec('node xml.js '+process.argv[2]+' '+process.argv[3]+' > test.xml').code !== 0) {
    shell.echo('Error: nmap scan failed');
    shell.exit(1);
}

if (shell.exec('searchsploit -j --nmap test.xml').code !== 0) {
    shell.echo('Error: searchsploit command failed');
    shell.exit(1);
}

if (shell.exec('node xmltojs.js > ports.json').code !== 0) {
    shell.echo('Error: test.xml conversion to ports.json failed');
    shell.exit(1);
}

